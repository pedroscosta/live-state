---
title: Server
---

The server is used to expose the Router to the world, it creates both the HTTP and WebSocket handlers. It also handles persistence.

## Creating a server

You can create a server using the `server` function, which takes a [schema](/docs/schema), [router](/docs/router) and a storage:

```ts title="server.ts"
import { server, SQLStorage } from "@live-state/sync/server";
import { schema } from "./schema";
import { appRouter } from "./router";
import { Pool } from "pg";

const lsServer = server({
  router: appRouter,
  storage: new SQLStorage(
    new Pool({
      connectionString: "postgresql://admin:admin@localhost:5442/live-state",
    })
  ),
  schema,
});
```

## Adapters

The server can be served using different adapters. As of right now, the only adapter is the Express adapter.

### Express

The Express adapter requires JSON and query string parsing. And as it's also a WebSocket server, it requires the use of `express-ws`.

```ts title="express-server.ts"
import express from "express";
import expressWs from "express-ws";
import { expressAdapter } from "@live-state/sync/server";
import { lsServer } from "./server";
import cors from "cors";

const { app } = expressWs(express());

app
  .use(express.urlencoded({ extended: true }))
  .use(express.json())
  .use(cors());

expressAdapter(app, lsServer);

app.listen(5001, () => console.log("api running on 5001"));
```
